<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>LWG Store</title>
  <link rel="stylesheet" href="css/styles.css"/>

  <style>
    :root{
      --bg:#0b1220; --line:#1f2937; --muted:#9ca3af; --text:#e5e7eb;
      --pill-bg:#0f172a; --pill-border:#374151; --price:#ef4444;
      --card:#0b1220;
    }

    /* Base */
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text)}
    img{max-width:100%;display:block}

    /* Top nav */
    .nav{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px 20px;border-bottom:1px solid var(--line);white-space:nowrap;
      position:sticky;top:0;background:var(--bg);z-index:10
    }
    .nav .row{display:flex;gap:10px;align-items:center;flex-wrap:nowrap}
    .btn.ghost{
      border:1px solid #374151;background:#0f172a;color:#e5e7eb;
      padding:8px 12px;border-radius:10px;text-decoration:none
    }
    .badge{
      background:#1f2937;border:1px solid #374151;padding:2px 8px;
      border-radius:999px;font-size:12px;margin-left:4px
    }
    .muted{color:var(--muted)}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}

    /* Grid + card */
    .grid{display:grid;gap:12px;grid-template-columns:1fr}
    @media (min-width:720px){ .grid{grid-template-columns:repeat(3,1fr)} }
    @media (min-width:1100px){ .grid{grid-template-columns:repeat(4,1fr)} }

    .card{
      display:flex;flex-direction:column;overflow:hidden;
      border:1px solid var(--line);border-radius:16px;background:var(--card);
      text-decoration:none;color:inherit;transition:transform .08s ease;
    }
    .card:active{transform:scale(.995)}
    @media (prefers-reduced-motion:reduce){ .card{transition:none} }

    .thumb{
      inline-size:100%;
      block-size:188px;
      object-fit:cover;object-position:center;background:#111827;
    }

    .body{padding:12px}
    .title{
      font-weight:600;line-height:1.3;min-height:2.6em;
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
      word-break:break-word;
    }
    .pill{
      display:inline-block;margin-top:8px;font-size:13px;
      background:var(--pill-bg);border:1px solid var(--pill-border);
      color:#c5d3f6;padding:6px 10px;border-radius:10px
    }
    .row{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap}
    .price{color:var(--price);font-weight:800;font-size:18px}

    .footer{
      border-top:1px solid var(--line);padding:16px;text-align:center;color:var(--muted)
    }
    .empty{color:var(--muted);margin-top:10px}
  </style>
</head>

<body>
  <!-- Top navigation -->
  <nav class="nav" aria-label="Primary">
    <div class="brand">
      <a href="index.html" style="display:flex;align-items:center;gap:10px;color:inherit;text-decoration:none">
        <span>LWG Store</span>
        <span class="badge">Shop</span>
      </a>
    </div>
    <div class="row">
      <a href="index.html" class="muted">Home</a>
      <a href="cart.html" class="btn ghost" aria-label="Open cart">
        Cart (<span id="cartCount">0</span>)
      </a>
      <a href="order-tracking.html" class="muted">Tracking</a>
    </div>
  </nav>

  <!-- MAIN content -->
  <main class="container" id="main">
    <h1 style="margin:8px 0 12px">Featured Products</h1>
    <section id="grid" class="grid" aria-live="polite"></section>
    <p id="empty" class="empty" hidden>No products yet. Add some in the Admin Dashboard, then refresh.</p>
  </main>

  <footer class="footer">
    © <span id="y"></span> LWG Partners Network — Creating Impact Globally
  </footer>

  <script>
    (function(){
      'use strict';

      // localStorage keys (aligned with your Store module)
      const LS_PRODUCTS = 'lwg_products_v1';
      const LS_CART     = 'lwg_cart_v1';

      // helpers
      const $ = s => document.querySelector(s);

      const money = n => {
        const v = Number(n||0);
        try { return 'NLe ' + v.toLocaleString(); }
        catch { return 'NLe ' + v; }
      };

      const getProducts = () => {
        try { return JSON.parse(localStorage.getItem(LS_PRODUCTS) || '[]'); }
        catch { return []; }
      };

      const getCart = () => {
        try { return JSON.parse(localStorage.getItem(LS_CART) || '[]'); }
        catch { return []; }
      };

      const updateCount = () => {
        const c = getCart().reduce((s,i)=> s + Number(i.qty||0), 0);
        $('#cartCount').textContent = String(c);
      };

      // build a product card (entire card is a link for a11y + semantics)
      function makeCard(p){
        const a = document.createElement('a');
        a.className = 'card';
        a.href = 'product.html?id=' + encodeURIComponent(p.id || '');
        a.setAttribute('aria-label', (p.title || 'Product') + ' — ' + money(p.price));

        const img = document.createElement('img');
        img.className = 'thumb';
        img.alt = p.title || 'Product image';
        img.src = p.image || '';
        img.addEventListener('error', ()=> {
          img.src = 'https://via.placeholder.com/600x400?text=No+Image';
        });

        const body = document.createElement('div');
        body.className = 'body';

        const title = document.createElement('div');
        title.className = 'title';
        title.textContent = p.title || 'Product';

        const pill = document.createElement('span');
        pill.className = 'pill';
        pill.textContent = 'Sierra Leone delivery';

        const row = document.createElement('div');
        row.className = 'row';

        const price = document.createElement('div');
        price.className = 'price';
        price.textContent = money(p.price);

        row.appendChild(price);
        body.appendChild(title);
        body.appendChild(pill);
        body.appendChild(row);

        a.appendChild(img);
        a.appendChild(body);
        return a;
      }

      // render
      const grid = $('#grid');
      const list = getProducts();
      if (!list || list.length === 0){
        $('#empty').hidden = false;
      } else {
        const frag = document.createDocumentFragment();
        list.forEach(p => frag.appendChild(makeCard(p)));
        grid.appendChild(frag);
      }

      // footer year and cart count
      $('#y').textContent = new Date().getFullYear();
      updateCount();
    })();
  </script>
</body>
</html>
